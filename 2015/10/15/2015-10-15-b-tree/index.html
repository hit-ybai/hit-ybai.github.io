<!DOCTYPE HTML>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>B-Tree | White</title>
  <meta name="author" content="Bai, Yu">
  
  <meta name="description" content="简介如果一个内部节点 X 包含了 n 个有序关键字，那么节点 X 有 n + 1 个子节点，每个叶节点有相同的深度即树的高度。
节点 X 由其关键字分隔为 n + 1 个子域，每个子域和一个子树相对应。在对一个关键字进行搜索时，会通过比较节点中关键字，进行 n + 1 路选择遍历查找。

节点中关键">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="B-Tree"/>
  <meta property="og:site_name" content="White"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="White" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">White</a><span class="split"></span><span class="title">B-Tree</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2015-10-15</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  

  
	<div class="col-md-12">
	  

	  <!-- content -->
	  <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>如果一个内部节点 <em>X</em> 包含了 <em>n</em> 个有序关键字，那么节点 <em>X</em> 有 <em>n + 1</em> 个子节点，每个叶节点有相同的深度即树的高度。</p>
<p>节点 <em>X</em> 由其关键字分隔为 <em>n + 1</em> 个子域，每个子域和一个子树相对应。在对一个关键字进行搜索时，会通过比较节点中关键字，进行 <em>n + 1</em> 路选择遍历查找。</p>
<p><img src="http://7xjra1.com1.z0.glb.clouddn.com/b-tree.png" alt="B-Tree"></p>
<p>节点中关键字的个数存在上下界，用<code>B-Tree</code>的最小度数 <em>t &gt;= 2</em> 来表示。非根节点至少有 <em>t - 1</em> 个关键字，即有 <em>t</em> 棵子树；至多有 <em>2t - 1</em> 个关键字，即有 <em>2t</em> 棵子树，这时我们称这个节点是满的。当 <em>t = 2</em> 时，每个内部节点有 2 个、 3 个或 4 个子树，即一棵 <em>2-3-4 树</em>。</p>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="B-TREE-SEARCH"><a href="#B-TREE-SEARCH" class="headerlink" title="B-TREE-SEARCH"></a>B-TREE-SEARCH</h3><p><code>class BTree</code><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(key)</span></span></div><div class="line">  b_tree_search(@root, key)</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">b_tree_search</span><span class="params">(node = <span class="literal">nil</span>, search_key)</span></span></div><div class="line">  <span class="keyword">return</span> <span class="literal">nil</span> <span class="keyword">unless</span> node</div><div class="line">  node.keys.each_with_index <span class="keyword">do</span> <span class="params">|key, idx|</span></div><div class="line">    <span class="keyword">return</span> [node, idx] <span class="keyword">if</span> search_key == key</div><div class="line">    <span class="keyword">next</span> <span class="keyword">if</span> search_key &gt; key</div><div class="line">    b_tree_search(node.child[idx], key)</div><div class="line">    <span class="keyword">break</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  b_tree_search(node.child.last, key)</div><div class="line">  <span class="literal">nil</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="B-TREE-CREATE"><a href="#B-TREE-CREATE" class="headerlink" title="B-TREE-CREATE"></a>B-TREE-CREATE</h3><p><code>class Node</code><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize</span></span></div><div class="line">  @leaf  = <span class="literal">true</span></div><div class="line">  @keys  = []</div><div class="line">  @child = []</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p><code>class BTree</code><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize</span></span></div><div class="line">  @root = Node.new</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="插入关键字"><a href="#插入关键字" class="headerlink" title="插入关键字"></a>插入关键字</h3><p>我们无法直接新建一个叶节点，把关键字插入其中（这样的<code>B-Tree</code>可能是不合法的），所以我们会把新的关键字插入到已有的节点中。不过这样可能会导致一个节点关键字的数量超过它的上界，所以我们引入一个新的操作：分裂<code>B-Tree</code>中的节点。</p>
<h3 id="B-TREE-SPLIT-CHILD"><a href="#B-TREE-SPLIT-CHILD" class="headerlink" title="B-TREE-SPLIT-CHILD"></a>B-TREE-SPLIT-CHILD</h3><p><img src="http://7xjra1.com1.z0.glb.clouddn.com/b-tree-split-child.png" alt="B-TREE-SPLIT-CHILD"><br><code>class BTree</code><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">b_tree_split_node</span><span class="params">(node, pos)</span></span></div><div class="line">  new_child = Node.new</div><div class="line">  old_child = node.child[pos]</div><div class="line"></div><div class="line">  new_child.leaf  = old_child.leaf</div><div class="line">  new_child.keys  = old_child.pop(@t - <span class="number">1</span>)</div><div class="line">  new_child.child = old_child.pop(@t)</div><div class="line"></div><div class="line">  node.insert_child( new_child, pos + <span class="number">1</span> )</div><div class="line">  node.insert_key( old_child.keys.pop, pos )</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
	
		
			
		
	
		
			
			
		
	
		
			
			
			
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
	
	
		<li class="prev"><a href="/2015/11/13/2015-11-13-the-core-value-of-sde/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2015/06/28/2015-06-26-rails-request-to-response-two/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2017 Bai, Yu
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<script type="text/javascript">
var disqus_shortname = 'everkeyword';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>
